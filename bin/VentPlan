#!/bin/bash
#
# Copyright (C) 2005      Informationssysteme Ralf Bensmann.
# Copyright (C) 2009-2010 Informationssysteme Ralf Bensmann.
# Copyright (C) 2011-2012 at of coding UG (haftungsbeschrÃ¤nkt).
#
# Alle Rechte vorbehalten.
# All rights reserved.
#

# Operating system
OS=$(uname -s)
# Classpath
for jar in lib/*
do
    exclude=0
    for ex in juh.jar jurt.jar ridl.jar unoil.jar
    do
        if [ ${jar} == ${ex} ]; then
            exclude=1
            break
        fi
    done
    [ ${exclude} -eq 0 ] && LIB_CLASSPATH="${LIB_CLASSPATH}:${jar}"
done
# Skip first colon
LIB_CLASSPATH=$(echo ${LIB_CLASSPATH} | cut -c 2-)
CLASSPATH="${LIB_CLASSPATH}"
export CLASSPATH
# Set WAC temporary directory
case "${OS}" in
        Darwin | Linux | *BSD | SunOS)
            WACTMP=${TMPDIR}
        ;;
esac
[ -z "${WACTMP}" ] && WACTMP=tmp
WACTMP=${WACTMP}/wac
export WACTMP
mkdir -p ${WACTMP} 2>/dev/null
# Update
mv update/resources/* resources 2>>${WACTMP}/wac.log 1>&2
mv update/lib/* lib 2>>${WACTMP}/wac.log 1>&2
mv update/sql/* sql 2>>${WACTMP}/wac.log 1>&2
rm -rf update 2>>${WACTMP}/wac.log 1>&2
# Start
java -cp "${CLASSPATH}" griffon.swing.SwingApplication 2>>${WACTMP}/wac.log 1>&2
# Remove temporary directory
cd ${WACTMP}
cd ..
rm -rf wac
exit 0
