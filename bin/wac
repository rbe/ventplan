#!/bin/bash
#
# /Users/rbe/project/wac2/wac
# 
# Copyright (C) 2010 Informationssysteme Ralf Bensmann.
# Alle Rechte vorbehalten. Nutzungslizenz siehe http://www.bensmann.com/license_de.html
# All Rights Reserved. Use is subject to license terms, see http://www.bensmann.com/license_en.html
# 
# Created by: rbe
#

#JAVA_HOME=
#export JAVA_HOME
#PATH=$JAVA_HOME/bin:$PATH
#export PATH

# Operating system
OS=$(uname -s)

# Installation directory
case "${OS}" in
	Darwin)
		OOO_HOME=${OOO_HOME:-/Applications/OpenOffice.org.app/Contents}
		# MacOS X: Don't use program link
		# http://www.openoffice.org/issues/show_bug.cgi?id=101203
		OOO_PROGRAM=${OOO_HOME}/MacOS
	;;
	SunOS)
		OOO_HOME=${OOO_HOME:-/opt/openoffice.org3}
		OOO_PROGRAM=${OOO_HOME}/program
	;;
	Linux)
		OOO_HOME=${OOO_HOME:-/usr/lib/openoffice}
		OOO_PROGRAM=${OOO_HOME}/program
	;;
	*BSD)
		OOO_HOME=${OOO_HOME:-/opt/openoffice.org3}
		OOO_PROGRAM=${OOO_HOME}/program
	;;
esac

# Libraries
case "${OS}" in
	Darwin | SunOS | Linux | *BSD)
		OOOJ="${OOO_HOME}/basis-link/ure-link/share/java"
		OOOU="${OOO_HOME}/basis-link/program/classes"
		OOOL="${OOO_HOME}/basis-link/program:${OOO_HOME}/basis-link/program/components:${OOO_HOME}/basis-link/ure-link/lib"
	;;
esac

# Set UNO path
UNO_PATH="${OOO_PROGRAM}"
export UNO_PATH

# Copy juh.jar into program folder
# http://user.services.openoffice.org/en/forum/viewtopic.php?f=44&t=10825
if [ ! -f ${OOO_PROGRAM}/juh.jar ]; then
        cp ${OOOJ}/juh.jar ${OOO_PROGRAM}
fi

# Start
CLASSPATH="${CLASSPATH}${OOO_PROGRAM}/juh.jar:${OOOJ}/jurt.jar:${OOOJ}/ridl.jar:${OOOU}/unoil.jar"
export CLASSPATH
cd dist
java -cp "${CLASSPATH}" -Djava.library.path="${OOOL}" -d32 -jar wac2.jar

exit 0
